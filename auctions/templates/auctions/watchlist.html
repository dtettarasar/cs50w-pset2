{% extends "auctions/layout.html" %}

{% block body %}

{% load static %}

    <div class="container-fluid my-5">

        <div id="hero" class="p-5 text-center rounded-3">

            <i class="bi bi-fire"></i>

            <div class="separator mt-3 mb-3 rounded-3"></div>

            <h2 class="text-white">My Watchlist</h2>

        </div>

    </div>

    <div class="container mt-4">

        {% if user.is_authenticated %}

            <div class="row" data-masonry='{"percentPosition": true }'>

                {% for watchlist in user_watchlist %}

                    <div class="col-sm-4 mt-3">

                        <div class="card">

                            {% if watchlist.listing.img_url %}

                                <img class="card-img-top" src="{{ watchlist.listing.img_url }}">

                            {% else %}

                                <img src="{% static 'auctions/img/no-img_placeholder.png' %}" class="card-img-top" alt="Placeholder image">

                            {% endif %}

                            <div class="card-body">

                                <h3 class="card-title">{{ watchlist.listing.title }}</h3>
                                <p class="card-text">{{ watchlist.listing.description }}</p>
                                <a href="{% url 'auctions:view_listing' watchlist.listing.id %}" class="btn btn-primary"><i class="bi bi-info-circle-fill"></i> More details</a>

                                <form class="mt-2" action="{% url 'auctions:remove_from_watchlist' watchlist.listing.id %}" method="post" >

                                    {% csrf_token %}
                                    <input type="hidden" name="next" value="{% url 'auctions:watchlist' %}">
                                    <button type="submit" class="btn btn-danger"><i class="bi bi-bookmark-x-fill"></i> Remove from watchlist</button>

                                </form>

                            </div>

                            <ul class="list-group list-group-flush h5">
                                
                                <li class="list-group-item"><strong><i class="bi bi-person-circle"></i> Created by:</strong> {{ watchlist.listing.creator.username }}</li>
                                <li class="list-group-item"><strong><i class="bi bi-calendar"></i> Created at:</strong> {{ watchlist.listing.formatted_date }}</li>

                                {% if watchlist.listing.category.cat_name %}
                                    <li class="list-group-item"><strong><i class="bi bi-tag-fill"></i> Category:</strong> {{ watchlist.listing.category.cat_name }}</li>
                                {% endif %}


                                <li class="list-group-item"><i class="bi bi-currency-exchange"></i> Price: {{ watchlist.listing.formatted_bid }}</li>

                            </ul>

                        </div>

                    </div>

                {% empty %}

                    <div class="alert alert-info mt-3" role="alert">
                        <i class="bi bi-info-circle-fill"></i> Your watchlist is empty! Check the active listing and add some :)
                    </div>

                    <div class="mt-3">

                        <button type="button" class="btn btn-primary">
                            <a style="color:#fff;text-decoration:none;" href="{% url 'auctions:index' %}">
                                <i class="bi bi-fire"></i> Active listing
                            </a>
                        </button>

                    </div>

                {% endfor %}

            </div>

        {% else %}

            <div class="alert alert-info mt-3" role="alert">
                <i class="bi bi-info-circle-fill"></i> Please make sure you're logged in to your account to create a listing
            </div>

            <div class="mt-3">

                <button type="button" class="btn btn-primary">
                    <a style="color:#fff;text-decoration:none;" href="{% url 'auctions:login' %}">
                        <i class="bi bi-person-fill-check"></i> Log in
                    </a>
                </button>

            </div>

        {% endif %}

    </div>


{% endblock %}